montageDefine("300a273","core/core",{dependencies:["collections/shim","./shim/object","./shim/array","./shim/string","./extras/object","./extras/date","./extras/element","./extras/function","./extras/regexp","./extras/string","./deprecate","./uuid","collections/listen/property-changes","frb","collections/weak-map","collections/map","frb/parse","frb/evaluate","frb/assign","frb/bind","frb/compile-observer","frb/scope","frb/observers","./serialization/bindings","./promise"],factory:function(t,e){function a(t,e){var n=i+e+s;return t.hasOwnProperty(n)?t[n]:Object.defineProperty(t,n,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(a(Object.getPrototypeOf(t),e))})[n]}t("collections/shim"),t("./shim/object"),t("./shim/array"),t("./shim/string"),t("./extras/object"),t("./extras/date"),t("./extras/element"),t("./extras/function"),t("./extras/regexp"),t("./extras/string");var n=t("./deprecate"),s="AttributeProperties",i="_",r="__proto__",l="value",c="enumerable",o="distinct",h="serializable",p=Array.prototype,g=Object.prototype,d=!0,m=e.Montage=function m(){};m.deprecate=n.deprecateMethod(m,n.deprecateMethod,"Montage.deprecate","deprecate module's deprecateMethod"),m.callDeprecatedFunction=n.deprecateMethod(m,n.callDeprecatedFunction,"Montage.callDeprecatedFunction","deprecate module's callDeprecatedFunction");var u={}.__proto__===Object.prototype,L={_montage_metadata:1,__state__:1},v=Object.getOwnPropertyNames(Function);if(Object.defineProperty(m,"specialize",{value:function(t,e){var a,s,i,r,l,c,o,h=this,p=this.specialize===void 0;if(t=t||Object.empty,e=e||Object.empty,a=t.constructor&&t.constructor.value?t.constructor.value:t.didCreate&&t.didCreate.value?m.deprecate(null,t.didCreate.value,"didCreate","constructor"):function(){return this.superForValue("constructor")()||this},u)a.__proto__=h;else{i=Object.getOwnPropertyNames(h);for(var c=0;i.length>c;c++)r=i[c],L.hasOwnProperty(r)||(l=Object.getOwnPropertyDescriptor(a,r),(!l||l.configurable)&&m.defineProperty(a,r,Object.getOwnPropertyDescriptor(h,r)));a.__constructorProto__=h,m.defineProperty(a,"isPrototypeOf",{value:function(t){for(;null!==t;){if(Object.getPrototypeOf(t)===this)return!0;t=Object.getPrototypeOf(t)}return!1},enumerable:!1})}if(s=Object.create(this.prototype),p){for(i=Object.getOwnPropertyNames(m),c=0;i.length>c;c++)r=i[c],l=Object.getOwnPropertyDescriptor(a,r),(!l||l.configurable)&&m.defineProperty(a,r,Object.getOwnPropertyDescriptor(m,r));for(i=Object.getOwnPropertyNames(m.prototype),c=0;i.length>c;c++)r=i[c],l=Object.getOwnPropertyDescriptor(a,r),(!l||l.configurable)&&m.defineProperty(s,r,Object.getOwnPropertyDescriptor(m.prototype,r))}if(m.defineProperties(s,t),d){o=function(t,e,a){function s(){return this===e&&n.deprecationWarning(m.getInfoForObject(e).objectName+"."+a+" should be moved to constructorProperties",null,3),t.apply(this,arguments)}return s.deprecatedFunction=t,s};for(r in t)v.has(r)?delete t[r]:(l=t[r],l.value&&"function"==typeof l.value&&!l.value.__isConstructor__?l.value=o(l.value,a,r):(l.get&&(l.get=o(l.get,a,r)),l.set&&(l.set=o(l.set,a,r))));m.defineProperties(a,t),m.defineProperty(a,"create",{value:function(){return new a},enumerable:!1})}return m.defineProperties(a,e),m.defineProperty(a,"__isConstructor__",{value:!0,enumerable:!1}),m.defineProperty(a,"_superCache",{value:{},enumerable:!1}),a.prototype=s,m.defineProperty(s,"constructor",{value:a,enumerable:!1}),a},writable:!0,configurable:!0,enumerable:!1}),!u){var f=Object.getPrototypeOf;Object.getPrototypeOf=function(t){return"function"==typeof t&&t.__constructorProto__?t.__constructorProto__:f.apply(Object,arguments)}}Object.defineProperty(m,"create",{configurable:!0,value:function(t,e){if(n.deprecationWarning("Montage.create()","Montage.specialize() or new Component()"),void 0!==t&&"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object or null, not '"+t+"'");if(t=t===void 0?this:t,"function"==typeof t)return e?t.specialize(e):new t;var a=Object.create(t);return e&&m.defineProperties(a,e),a}});var C=[h];C.forEach(function(t){Object.defineProperty(Object.prototype,i+t+s,{enumerable:!1,configurable:!1,writable:!0,value:{}})}),Object.defineProperty(m,"defineProperty",{value:function(t,e,n){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object must be an object, not '"+t+"'");var s=l in n;if(o in n&&!s)throw new TypeError("Cannot use distinct attribute on non-value property '"+e+"'");if(r in n)n.__proto__=s?"function"==typeof n.value?x:w:M;else{var d;d=s?"function"==typeof n.value?x:w:M;for(var m in d)m in n||(n[m]=d[m])}if(n.hasOwnProperty(c)||e.charAt(0)!==i||(n.enumerable=!1),n.hasOwnProperty(h)||(n.enumerable?n.get&&!n.set?n.serializable=!1:n.writable===!1&&(n.serializable=!1):n.serializable=!1),h in n&&(a(t,h)[e]=n.serializable),n.distinct!==!0||"object"!=typeof n.value){var u,L,v;if(t._superDependencies){if("function"==typeof n.value&&(u=t._superDependencies[e+".value"]))for(L=0,v=u.length;v>L;L++)delete u[L]._superCache[e+".value"];if("function"==typeof n.get&&(u=t._superDependencies[e+".get"]))for(L=0,v=u.length;v>L;L++)delete u[L]._superCache[e+".get"];if("function"==typeof n.set&&(u=t._superDependencies[e+".set"]))for(L=0,v=u.length;v>L;L++)delete u[L]._superCache[e+".set"]}return Object.defineProperty(t,e,n)}(function(t,e,a,n){var s=function(t,e,a){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:a})};a.constructor===Object&&Object.getPrototypeOf(a)===g?0!==Object.keys(a).length?Object.defineProperty(n,t,{configurable:!0,get:function(){var t=this[e];if(!t){var n;t={};for(n in a)t[n]=a[n];this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}}):Object.defineProperty(n,t,{configurable:!0,get:function(){var t=this[e];return t||(t={},this.hasOwnProperty(e)?this[e]=t:s(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}}):(a.__proto__||Object.getPrototypeOf(a))===p?0!==a.length?Object.defineProperty(n,t,{configurable:!0,get:function(){var t=this[e];if(!t){var n,i;for(t=[],n=0;(i=a[n])!==void 0;n++)t[n]=i;this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}}):Object.defineProperty(n,t,{configurable:!0,get:function(){var t=this[e];return t||(t=[],this.hasOwnProperty(e)?this[e]=t:s(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}}):a.constructor.prototype===Object.getPrototypeOf(a)?Object.defineProperty(n,t,{configurable:!0,get:function(){var t=this[e];if(!t){var n;t=new a.constructor;for(n in a)t[n]=a[n];this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}}):Object.defineProperty(n,t,{configurable:!0,get:function(){var t=this[e];return t||(t=Object.create(a.__proto__||Object.getPrototypeOf(a)),this.hasOwnProperty(e)?this[e]=t:s(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:s(this,e,t)}})})(e,i+e,n.value,t)}}),Object.defineProperty(m,"defineProperties",{value:function(t,e){if("object"!=typeof e||null===e)throw new TypeError("Properties must be an object, not '"+e+"'");for(var a in e)"_bindingDescriptors"!==a&&this.defineProperty(t,a,e[a]);return t}});var M={enumerable:!0,configurable:!0,serializable:!0},w={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},x={writable:!0,enumerable:!1,configurable:!0,serializable:!1};m.defineProperty(m,"didCreate",{value:Function.noop});var z=function(t,e){var a,n,s,i,r,l,c,o,h;if(!e._superPropertyName||!e._superPropertyType)for(m.defineProperty(e,"_superPropertyType",{value:null}),m.defineProperty(e,"_superPropertyName",{value:null}),c=t;!o&&null!==c;){for(a=Object.getOwnPropertyNames(c),n=Object.getPrototypeOf(c),s=0,i=a.length,s;i>s;s++){if(r=a[s],h=Object.getOwnPropertyDescriptor(c,r),null!=(l=h.value)&&(l===e||l.deprecatedFunction===e)){e._superPropertyType="value",e._superPropertyName=r,o=!0;break}if(null!=(l=h.get)&&(l===e||l.deprecatedFunction===e)){e._superPropertyType="get",e._superPropertyName=r,o=!0;break}if(null!=(l=h.set)&&(l===e||l.deprecatedFunction===e)){e._superPropertyType="set",e._superPropertyName=r,o=!0;break}}c=n}return _(t,e._superPropertyType,e._superPropertyName,e)},y=function(){if("function"!=typeof y.caller)throw new TypeError("Can't get super without caller. Use this.superForValue(methodName) if using strict mode.");var t=z(this,y.caller);return"function"==typeof t?t.bind(this):Function.noop};m.defineProperty(m,"_superContext",{value:null});var _=function(t,e,a,n){var s,i,r,l,c,o=t,h=a+"."+e;if(t._superContext||(t._superContext={}),t._superContext[h])o=t._superContext[h];else for(o=t;null!==o&&(!o.hasOwnProperty(a)||(r=Object.getOwnPropertyDescriptor(o,a),"function"!=typeof r[e]));)o=Object.getPrototypeOf(o);if(l=o.constructor,l._superCache&&l._superCache[h])return c=function(t,e,a,n){return function(){e._superContext[t]=a;var s=n.apply(e,arguments);return delete e._superContext[t],s}}(h,t,l._superCache[h].owner,l._superCache[h].func);for(i=o;s===void 0&&(i=Object.getPrototypeOf(i));)if(i._superDependencies||m.defineProperty(i,"_superDependencies",{value:{}}),i._superDependencies[h]||(i._superDependencies[h]=[]),i._superDependencies[h].push(l),r=Object.getOwnPropertyDescriptor(i,a)){if("function"==typeof r[e]&&r[e]!==n){s=r[e];break}break}return"function"==typeof s?(c=function(t,e,a,n){return function(){e._superContext[t]=a;var s=n.apply(e,arguments);return delete e._superContext[t],s}}(h,t,i,s),l._superCache||m.defineProperty(l,"_superCache",{value:{}}),l._superCache[h]={func:s,owner:i},c):Function.noop},b=function(t){return _(this,"value",t,b.caller)},S=function(t){return _(this,"get",t,S.caller)},B=function(t){return _(this,"set",t,B.caller)};m.defineProperty(m,"super",{get:y,enumerable:!1}),m.defineProperty(m.prototype,"super",{get:y,enumerable:!1}),m.defineProperty(m,"superForValue",{value:b,enumerable:!1}),m.defineProperty(m.prototype,"superForValue",{value:b,enumerable:!1}),m.defineProperty(m,"superForGet",{value:S,enumerable:!1}),m.defineProperty(m.prototype,"superForGet",{value:S,enumerable:!1}),m.defineProperty(m,"superForSet",{value:B,enumerable:!1}),m.defineProperty(m.prototype,"superForSet",{value:B,enumerable:!1}),m.defineProperty(m,"getSerializablePropertyNames",{value:function(t){var e=[],a=t._serializableAttributeProperties;if(a)for(var n in a)a[n]&&e.push(n);return e}}),m.defineProperty(m,"getPropertyAttribute",{value:function(t,e,a){var n=i+a+s,r=t[n];return r?r[e]:void 0}}),m.defineProperty(m,"getPropertyAttributes",{value:function(t,e){var a={},n=i+e+s,r=t[n];if(r){for(var l in r)a[l]=r[l];return a}}});var P={isInstance:{value:!0}},T={objectName:{value:"Function"},isInstance:{value:!0}};m.defineProperty(m,"getInfoForObject",{value:function(t){var e,a;if(D.call(t,"_montage_metadata"))return t._montage_metadata;if(e=t._montage_metadata||t.constructor&&t.constructor._montage_metadata||null,a=t.constructor===Function?T:P,t===Object.prototype)return Object.create(e,a);try{return Object.defineProperty(t,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(e,a)})._montage_metadata}catch(n){return t._montage_metadata=Object.create(e,a)}}});var E=t("./uuid");"undefined"!=typeof window&&(window.uuid=E.generate());var D=Object.prototype.hasOwnProperty,k=function(){var t=E.generate(),e=m.getInfoForObject(this);try{null!==e&&e.isInstance===!1?(this._uuid=t,Object.defineProperty(this,"uuid",{get:function(){return this.hasOwnProperty("uuid")?this._uuid:k.call(this)}})):(e.isInstance&&Object.defineProperty(this,"uuid",{configurable:!0,enumerable:!1,writable:!1,value:t}),!(this instanceof Element)&&e.isInstance&&l in(Object.getOwnPropertyDescriptor(this,"uuid")||{})&&r in this||(this._uuid=t))}catch(a){}return this._uuid=t,t},O=function O(){return D.call(this,"_uuid")?this._uuid:k.call(this)};Object.defineProperty(Object.prototype,"_uuid",{enumerable:!1,value:null,writable:!0}),Object.defineProperty(Object.prototype,"uuid",{configurable:!0,get:O,set:function(){}}),m.defineProperty(m,"identifier",{value:null,serializable:!0}),m.defineProperty(m.prototype,"identifier",{value:null,serializable:!0}),m.defineProperty(m.prototype,"equals",{value:function(t){return t?this===t||this.uuid===t.uuid:!1}}),m.defineProperty(m,"equals",{value:m.prototype.equals}),m.defineProperty(m.prototype,"callDelegateMethod",{value:function(t){var e,a,n=this.delegate;return"string"==typeof this.identifier&&(e=this.identifier+t.toCapitalized(),n&&"function"==typeof(a=n[e]))?(p.shift.call(arguments),a.apply(n,arguments)):n&&"function"==typeof(a=n[t])?(p.shift.call(arguments),a.apply(n,arguments)):void 0}});var A=t("collections/listen/property-changes");Object.addEach(m,A.prototype),Object.addEach(m.prototype,A.prototype);var Y=e.Bindings=t("frb"),I={defineBinding:{value:function(t,e,a){return Y.defineBinding(this,t,e,a)}},defineBindings:{value:function(t,e){return Y.defineBindings(this,t,e)}},cancelBinding:{value:function(t){return Y.cancelBinding(this,t)}},cancelBindings:{value:function(){return Y.cancelBindings(this)}},getBinding:{value:function(t){return Y.getBinding(this,t)}},getBindings:{value:function(){return Y.getBindings(this)}}};m.defineProperties(m,I),m.defineProperties(m.prototype,I);var N=t("collections/weak-map"),X=t("collections/map"),F=t("frb/parse"),R=t("frb/evaluate"),j=t("frb/assign");t("frb/bind");var H=t("frb/compile-observer"),Z=t("frb/scope"),V=t("frb/observers"),W=V.autoCancelPrevious,U=new N,q={getPath:{value:function(t,e,a,n){return R(t,this,e||this,a,n)}},setPath:{value:function(t,e,a,n,s){return j(this,t,e,a||this,n,s)}},observePath:{value:function(t,e){var a=F(t),n=H(a);return n(W(e),new Z(this))}},addRangeAtPathChangeListener:{value:function(t,e,a,n,s,i){function r(t,n,s){if(e[a])e[a](t,n,s);else{if(!e.call)throw Error("Can't dispatch range change to "+e);e.call(null,t,n,s)}}a=a||"handleRangeChange";var l=[];return this.addPathChangeListener(t,function(t){return t&&t.toArray&&t.addRangeChangeListener?(r(t.toArray(),l.toArray(),0),l=t,t.addRangeChangeListener(r)):(t=[],r(t,l,0),l=t,void 0)},void 0,void 0,n,s,i)}},getPathChangeDescriptors:{value:function(){return U.has(this)||U.set(this,{}),U.get(this)}},getPathChangeDescriptor:{value:function(t,e,a){var n=m.getPathChangeDescriptors.call(this);return Object.owns(n,t)||(n[t]={willChangeListeners:new X,changeListeners:new X}),n=n[t],n=a?n.willChangeListeners:n.changeListeners,n.has(e)||n.set(e,{path:t,handler:e,beforeChange:a,cancel:Function.noop}),n.get(e)}},addPathChangeListener:{value:function(t,e,a,n,s,i,r){var l=this;e=e||Function.noop;var c=m.getPathChangeDescriptor.call(this,t,e,n);c.cancel();var o,h,p,g=F(t);if(e===Function.noop)p=function(e){if(h)throw Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(t));h=!0,o=e};else if(a)p=function(n){return e[a].call(e,n,t,l)};else if(e.handlePathChange)p=function(a){return e.handlePathChange.call(e,a,t,l)};else{if("function"!=typeof e)throw Error("Can't recognize handler type: "+e+". Must be function or delegate implementing handlePathChange.");p=function(a){return e.call(l,a,t,l)}}var d=H(g),u=new Z(this);u.beforeChange=n,u.parameters=s,u.document=i,u.components=r;var L=d(W(p),u);return c.cancel=L,h?o:L}},removePathChangeListener:{value:function(t,e,a){e=e||Function.noop;var n=m.getPathChangeDescriptors.call(this),s=a?"willChangeListeners":"changeListeners";if(!Object.owns(n,t))throw Error("Can't find "+s+" for "+JSON.stringify(t));var i=n[t],r=i[s];if(!r.has(e))throw Error("Can't find "+s+" for "+JSON.stringify(t));var l=r.get(e);l.cancel(),r["delete"](e),0===i.willChangeListeners.length&&0===i.changeListeners.length&&delete n[t];for(var c in n)return;U["delete"](this)}},addBeforePathChangeListener:{value:function(t,e,a,n,s,i){return m.addPathChangeListener.call(this,t,e,a,!0,n,s,i)}},removeBeforePathChangeListener:{value:function(t,e){return m.removePathChangeListener.call(this,t,e,!0)}}};m.defineProperties(m,q),m.defineProperties(m.prototype,q),t("./serialization/bindings"),e._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var t=m.getInfoForObject(this),e=t&&!t.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(e,"_blueprintModuleId")||!e._blueprintModuleId){t=m.getInfoForObject(e);var a=t.moduleId,n=a.lastIndexOf("/"),s=a.lastIndexOf(".");n=-1===n?0:n+1,s=-1===s?a.length:s,s=n>s?a.length:s,m.defineProperty(e,"_blueprintModuleId",{enumerable:!1,value:a.slice(0,s)+".meta"})}return e._blueprintModuleId}},e._blueprintDescriptor={serializable:!1,enumerable:!1,get:function(){var a=m.getInfoForObject(this),n=a&&!a.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(n,"_blueprint")||!n._blueprint){var s=n.blueprintModuleId;if(""===s)throw new TypeError("Blueprint moduleId undefined for the module '"+JSON.stringify(n)+"'");e._blueprintDescriptor.BlueprintModulePromise||(e._blueprintDescriptor.BlueprintModulePromise=t.async("core/meta/module-blueprint").get("ModuleBlueprint")),m.defineProperty(n,"_blueprint",{enumerable:!1,value:e._blueprintDescriptor.BlueprintModulePromise.then(function(t){var e=m.getInfoForObject(n);return t.getBlueprintWithModuleId(s,e.require).fail(function(e){if(-1!==e.message.indexOf("Can't XHR"))return t.createDefaultBlueprintForObject(n).then(function(t){return t});throw e})})})}return n._blueprint},set:function(e){var a,n=m.getInfoForObject(this),s=n&&!n.isInstance?this:this.constructor;if(null===e)a=null;else{if("function"==typeof e.then)throw new TypeError("Object blueprint should not be a promise");e.blueprintInstanceModule=s.blueprintModule,a=t("./promise").Promise.resolve(e)}m.defineProperty(s,"_blueprint",{enumerable:!1,value:a})}}}});