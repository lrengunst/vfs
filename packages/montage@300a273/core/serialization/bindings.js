var Bindings=require("frb"),stringify=require("frb/stringify"),expand=require("frb/expand"),Scope=require("frb/scope"),Serializer=require("core/serialization/serializer/montage-serializer").MontageSerializer,Deserializer=require("core/serialization/deserializer/montage-deserializer").MontageDeserializer;Serializer.defineSerializationUnit("bindings",function(t,e){var n,i=Bindings.getBindings(e),r={};for(var a in i){var s=i[a],l={};if(!("serializable"in s)||s.serializable){var o=s.sourcePath,c=s.sourceSyntax;if(s.source!==e){var u=t.getObjectLabel(s.source),h=new Scope({type:"component",label:u});h.components=t,c=expand(c,h)}var h=new Scope;h.components=t,o=stringify(c,h),s.twoWay?l["<->"]=o:l["<-"]=o,s.converter?l.converter=s.converter:(l.convert=s.convert,l.revert=s.revert),s.trace&&(l.trace=!0),r[a]=l,n=!0}}return n?r:void 0}),Deserializer.defineDeserializationUnit("bindings",function(t,e,n){for(var i in n){var r=n[i];if("object"!=typeof r)throw Error("Binding descriptor must be an object, not "+typeof r);"boundObject"in r?(r.source=t.getObjectByLabel(r.boundObject),r.oneway?r["<-"]=r.boundPropertyPath:r["<->"]=r.boundPropertyPath,delete r.boundObject,delete r.boundObjectPropertyPath,delete r.oneway):r["<<->"]&&(console.warn("WARNING: <<-> in bindings is deprectated, use <-> only, please update now."),r["<->"]=r["<<->"],delete r["<<->"])}Bindings.defineBindings(e,n,{components:t})});